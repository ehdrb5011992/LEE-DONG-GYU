1교시

숙제 : two sample T와 ANOVA하나씩 (2-2, 2-7) 을 R과 SAS로 해보기.
공부 tip) '~라고 가정하자' 라는 문구를 조심하면서 글을 읽기.
 
<1장>

4페이지
서론: 두 그룹의 평균을 비교 or 전후의 차이를 비교, 상관계수가 어떻다 -> 기초통계에서 배움

6주후 시험약과 ~ 공분산분석을 실시하였다.

5페이지 위
실험실 ~ 환자 ~ 카이제곱, 로그선형모형을 사용하겠다. / 회귀분석을 시행한다.
반복측정된 자료분석 ~ 
보조결과분석 ~ 피셔의 ~ 사용하겠다.
카플란 마이어 방법을 이용해 생존분석~
어떤 방법이 좋은것에 대해 로그선형 ~ , cox의 회귀분석을 이용한다~

지금 말한것 들을 어떤과목을 통해서든 들어봤다면 7주가 쉬울것이다.
안배웠다면 정말로 보람찬 7주가 될 것이다.

-생명과학 뿐 아니라 두루두루 여러분야에서 사용하는 방법론들이기에 다배운다.
-요점만 배우는 넓고 얉게 배우기에, 이만한 과목이 없고, 그러기에 석종에 포함됨.
-정신 똑바로 차리고 잘들어라


6페이지

가설검정의 원리
기초통계에서는 가설검정할때는 mu1 mu2 이런걸 얘기하고, 공식에 의존했다. 다시 설명할거임.
가설검정에 대한 탄탄한 이해가 뒷받침이 되야 다음 내용들이 이해됨.

7페이지
귀무가설 대립가설 1종오류 2종오류 유의수준 등등 여러개가 나온다.

ex)
토끼오리 가설검정
H_0 : 오리
H_1 : 토끼 (대립가설 = 연구가설) : 관심있는것은 대립가설 하나만 있는거임.

그래서 대립가설을 보이려다가 못보이면 저절로 귀무가설이 되는 알고리즘임.
귀무 : '무로 돌아간다.' 라는 뜻. 
토끼를 보이려다가 충분하지 않으면 오리라고 받아들이는거임.


재판에서도 마찬가지
무죄를 입증하는게아니라, 유죄인 증거가 없으면 찝찝하지만 넘어가는거임.

그러므로, 통계에는 accept H_0 라는 통계용어는 없다. (귀무가설은 채택하는 요소가 아닌거임!)
reject H_0 or not reject H_0 임. (단, accept H_1 은 있음.)

다음은 1종오류, 2종오류에 대한 이야기를 간단히 해보자.
심각한 순서대로 alpha오류, beta오류임.
H_0 : 무죄 vs H_1 : 유죄 인 경우를 생각하면 쉽게 입증 할 수 있다.

그리고 H_1을 받아들일 때, H_1이 참이다라고 하는 확률이 power(검정력) = 1-beta 라고 함.

alpha , beta는 같이 내리고 싶어도 같이 내릴수가 없다. (둘은 서로 tradeoff가 됨)
이때 우리는 다음과 같은 행동을 취한다.
alpha가 워낙 심각하니, 정해놓고 beta를 최소화한다.

이때 말하는 1종오류의 최종허용한계를 유의수준이라고 말한다. (즉 , 유의수준과 1종오류는 다르다.)
보통 최대허용한계를 다 쓰기때문에 유의수준을 그냥 1종오류라고 말하는거긴 하지만.

관측치에 근거해서 귀무가설을 기각하는 쪽으로의 확률 = p - value라고 한다.
즉 , p-value가 alpha보다 작다는 이야기는, 내 검정통계량 값이 기각치의 오른쪽에 있다는 뜻.
그래서 0.05보다 작으면 기각.

여기 공부하면서 부족한거 있으면 기초통계 다시 복습.

8페이지
단측검정 이야기 나옴.



<2장>

집단의 비교 (기초통계-연속형 일때 다들어있음)

two sample t , anova , pair t  // test

두 집단의 평균비교 :
1) 모분산이 알려져 있을 때~ (정규분포 쓰면됨)
2) 모분산이 알려지지 않을 때 아예 아무런 정보가 없을때~
3) 모분산이 알려지지 않을 때 모분산이 같다는 정보만 있는지~ (pooling)

X~N(mu1,sigma1^2)
Y~N(mu2,sigma2^2) - 두그룹이 독립 : one-sample t

bar(x) - bar(y) 를 분자로 갖으면서
2) 분모 : sqrt(s1^2/n1 + s2^2/n2) 자유도 : satterthwaite 자유도 - 공식이있음.
3)) 분모 : sqrt(sp^2 (1/n1 + 1/n2) ) 자유도 : n1+n2 - 2

18페이지에 2.4 output을 보면,
16명중 9명 중,
variance가 equal 이냐 아니냐 가 나와있고 satterthwaite 자유도가 있음. 15.6 (equal) /// 23 (not equal)

17페이지? 에 보면
그래서 분산이 같은지, 다른지에 대한 검정이 있는거임.
모분산에 대한 검정.

T와 Z의 차이
- 그림으로는 T가 두꺼운 꼬리

403페이지에 t분표를 봐라
무한대 자유도의 0.975를 보면, 1.96이다. 이게 z_alpha/2임. 
자유도 120이어도 0.975 보면 1.98 임. 1.97일 경우는 이 사이에 있어서 기각 하고 말고가 다른 결과가 나옴.
-> 대형사고 친거임.

임상시험에 5조정도의 비용이 듦. - 0.0500001 이면 기각 못시켜서 5조 날림
0.04999999998이면 기각시켜서 수백조를 벎. 리얼임.
T는 Z가 될 수 없다. 아무리 n이 커도 Z로 안하고 T를 가지고 함.
T = Z / sqrt(chisq_n / n ) 

19페이지는 짝지어서 하는경우는, pair t test 임.



2교시


<2장 이어서. 2.3절>

ANOVA
y_ij = mu_i + epsilon_ij = mu+alpha_i + epsilon_ij  , i=1, ... , k // j=1 , ... , n_i  // epsilon_ij ~ i.i.d. N(0,sigma^2)

1) N 가정이 없다 -> 비모수
2) 분산이 등분산이 아니다 -> 시계열
3) sigma_i^2 -> GLSE

ex) 세도시의 평균 소득의 비교를 하고싶다 -> 각 도시의 분산이 같다면, 바로 ANOVA를 하면 된다.
분산이 다르면 (등분산성을 만족하지 못하면) 매우 신중해야함. 이 작업을 EDA를 통해서 진행하게 됨.
가정(정규성, 등분산성 등)을 체크하는것부터 해야함. 

23페이지

SST = SSt + SSE 임을 알자. (ANOVA의 원리)
또한, MSt / MSE 로 세도시의 평균소득의 비교를 할 수 있게 된다. 
이렇게 보는 이유는 통계량의 분포에서 SSE/sigma^2으로 하게되면, sigma^2을 알아야만 하는 상황에 부딪힘.
그러므로, MSt와 MSE의 비를 보고, 이로부터 분포를 얻어내어 추정하게 된다. (이는 값 또한 단조증가이기에 매우 좋다)

지금 이 문제와 비모수는 어떻게 연결이 되는가?
if) 오차항이 정규분포를 안따르는 경우.
-> 비모수(크루스칼 왈리스 검정)으로 시행한다.
kruskal-wallis 통계량 의 이치 : sum(sum( bar(y_i ) - bar(y) )^2 ) 이 rank로 바뀔때, 
바로 그게 KW통계량임. (y_i 대신, 등수를 쓰는것.) 무척 간단함. 
이 때문에, sigma^2이 필요 없는거임. 

이렇게 항상 기본에 충실할 것. 모르겠으면 비모수, 기초통계학 뒤져보면서 공부할것.
암기식으로 분석하지말기.

표 2.11 처럼 분삭분석표가 나올수밖에 없다.
그다음에 sas로 적용된것 확인.

이제, 위의 세 도시에서 소득이 같은것이라는 귀무가설이 기각되었다고 하자.
그러면 어느집단에서 차이가 있는지는 어떻게 살펴볼 것인가?

유의수준을 조정해서 다중비교를 해야한다. - 상황에 따라 비교하는 방법은 다양함.
본페로니 방법 : alpha를 각 케이스로 나눠준다. 무척 보수적인 방법
ex)
mu1=mu2=mu3있으면 , 5%/3으로 해서 유의수준을 조절(1.3%)한다.
개수가 많아질 때 기각을 못하는 상황이 발생하므로 무척 보수적임.

이에 덜 보수적인 방법들이 LSD, 튜키 , 셰폐, 방법 등등이 있음.
27페이지에 잘 나와있음 정독.
표 2.16에는 23명짜리때문에 기각이 된거임. 깔끔하게 Multiple comparison까지 해야함.


